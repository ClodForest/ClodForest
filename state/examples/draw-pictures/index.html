<!DOCTYPE html>
<html>
<head>
    <title>Refactored Parametric Function Playground</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h2>🌈 Refactored Parametric Function Playground</h2>
    <p>Featuring dependency injection, configuration objects, and clean separation of concerns!</p>
    
    <div class="editor-panel">
        <div>
            <h3>Position Function</h3>
            <p>Returns {x, y} coordinates in range [-1, 1]</p>
            <textarea id="positionCode" rows="6">const tRadians = t * 2 * PI;
return {
  x: sin(tRadians) * 2,
  y: cos(tRadians) * 3
};</textarea>
        </div>
        
        <div>
            <h3>Color Function</h3>
            <p>Returns {r, g, b, a} values in range [0, 1]</p>
            <textarea id="colorCode" rows="6">const oneThirdCircle = (whichThird) => (Tau / 3) * whichThird;
return {
  r: colorClamp(sin(t + oneThirdCircle(0))),
  g: colorClamp(sin(t + oneThirdCircle(1))), 
  b: colorClamp(sin(t + oneThirdCircle(2))),
  a: 1
};</textarea>
        </div>
    </div>
    
    <canvas id="spiralCanvas" width="400" height="400"></canvas>
    
    <div class="controls">
        <button onclick="loadPreset('original')">🎨 Original</button>
        <button onclick="loadPreset('spiral')">🌀 Spiral</button>
        <button onclick="loadPreset('lissajous')">∞ Lissajous</button>
        <button onclick="loadPreset('rose')">🌹 Rose</button>
        <button onclick="renderWithDebugInfo()">🔍 Debug Adaptive</button>
        <button onclick="renderWithSampler(fixedStepSampler(AppState.getPositionFunc(), 100))">📐 Fixed 100</button>
        <button onclick="clearCanvas()">Clear</button>
    </div>
    
    <p id="status">Ready to compile!</p>
    <div class="perf-info">
        <p>✨ Refactored with: Dependency injection • Configuration objects • Separation of concerns</p>
        <p>🔧 Step adjustment: Up to 3 attempts • Distance optimization • Function-space scaling</p>
    </div>

    <!-- Load all JavaScript modules -->
    <script src="config.js"></script>
    <script src="state.js"></script>
    <script src="compiler.js"></script>
    <script src="ui.js"></script>
    <script src="presets.js"></script>
    <script src="sampler-utils.js"></script>
    <script src="sampler.js"></script>
    <script src="renderer.js"></script>
    <script src="main.js"></script>
</body>
</html>

